<!-- # Настройка MediaWiki -->

#### Настройка MediaWiki

1. Установка пакетов на всех серверах MediaWiki


   <details>
   <summary>Развернуть</summary> 
   
    - Обновление пакетов репозитория, добавление в автозагрузку

          sudo apt update && sudo apt upgrade -y

    - Установка пакетов  
    
          sudo apt install -y nginx php php-intl php-mbstring php-xml php-apcu php-curl install php8.1-fpm php8.1-pgsql postgresql postgresql-contrib python3-psycopg2 acl rsync python3 python3-venv python3-pip

    - Добавление в автозагрузку nginx и postgresql
 
          sudo systemctl enable nginx
          sudo systemctl enable postgresql
          sudo systemctl restart nginx

    - Проверка установки, автозапуска и статуса служб nginx и postgresql 

          systemctl is-enabled nginx
          sudo systemctl restart nginx
          systemctl status nginx

   </details>  
  
2. Скачивание и распаковка MediaWiki на vm-3-mediawiki-server-1

   <details>
   <summary>Развернуть</summary> 

    - Скачивание архива с MediaWiki в /var/www/

          sudo wget -P /var/www/ https://releases.wikimedia.org/mediawiki/1.42/mediawiki-1.42.3.tar.gz

    - Распаковка архива c MediaWiki в /var/www/

          sudo tar -xzvf /var/www/mediawiki-1.42.3.tar.gz -C /var/www/

    - Переименование распакованной папки    

          sudo mv /var/www/mediawiki-1.42.3 /var/www/mediawiki

    - Удаление архива   

          sudo rm -r /var/www/mediawiki-1.42.3.tar.gz

   </details>  


3. Настройка Nginx на vm-3-mediawiki-server-1

   <details>
   <summary>Развернуть</summary> 

    - Удаление архива   

          sudo rm -r /var/www/mediawiki-1.42.3.tar.gz

   </details>  


2. Test Header2


   <details>
   <summary>Развернуть</summary> 
   
    - Создание новой роли 

          # Создание новых пользователей: wikiuser (основной), syncuser (для репликации)
          sudo -u postgres createuser -P wikiuser
          sudo -u postgres createuser --replication -P syncuser
              - --replication - право на репликацию
          # Создание базы данных
          sudo su - postgres
          psql
          CREATE DATABASE my_wiki;
          # Назначение пользователю прав на базу данных
          sudo su - postgres
          psql
          GRANT ALL PRIVILEGES ON DATABASE my_wiki to wikiuser; 
          # Вывод списка пользоватей с правами
          psql
          \\du
          # Вывод списка баз данных
          \\l


    </details>  
